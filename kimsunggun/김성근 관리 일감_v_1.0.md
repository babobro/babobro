# 나는 야구감독이다 - 김성근 버전

[TOC]


### 기능 개발 리스트
* 한줄 공지
* 월간 패키지 상품 시스템화
* 도전모드 개선


### 기능별 진행 상황

| 기능명    |   기획	 	|	 디자인	| 	서버		| DB	   | 클라이언트 | 진행도  |
|:--------:|:---------:|:-----------:|:----------:|:--------:|:--------:|:------:|
|한줄공지|90%|0%|0%|0%|0%|10%|
|월간 패키지 상품 시스템화|10%||||||
|도전모드 개선||||||||

### 7/24 기준 기능별 개발 소요 일정(워크데이 기준)

| 기능명    | 	서버		| DB	   | 클라이언트 |
|:--------:|:---------:|:--------:|:--------:|
|한줄공지|5일|-|7일|
|월간 패키지 상품 시스템화|2일|5일|4일|
|총 필요 일정|12일|10일|18일|
	* 개발 완료 후 마무리 테스트 작업까지 진행 할 경우 클라이언트 완료 시점에서 1~2일 가량 더 소요 될 것으로 보임
	* 디자인 일정은 큰 이슈가 없어 개발 일정에 영향을 끼치지 않아 제거하였음
	* 기획 안은 모두 완료 및 공유 되었음

* * *


#### ==한줄 공지==
* 기능 설명
	* 게임 내에서 발생한 특정 이슈에 대한 정보를 안내해주는 기능
* 도입 배경
	* 해당 기능을 통하여 유저 텐션 유지 및 증가를 유도
* 목표
	* 유저 텐션 유지 및 증가를 통한 매출 증대
* 수행 방식
	* DB에서 한줄 공지 테이블에 노출될 정보 지속 저장
	* 매 60초마다 서버에서 DB에 기록된 정보를 호출
	* 클라이언트에서 특정 시간 간격(60초)으로 해당 한줄 공지 정보를 호출
		* 최초 클라이언트 접속 이후 매 60초 간격으로 서버에 해당 정보 호출
	* 클라이언트 호출이 있을 경우 저장된 테이블을 클라이언트에 전송
		* 클라이언트에서 해당 정보를 가져와 60초 동안 최대 6건의 정보를 노출
		* 각 정보는 최대 5초간 화면에 노출
		* 첫번째 정보 노출 5초 -> 정보 미노출 5초 -> 두번째 정보 노출 5초 -> 정보 미노출 5초 -> ... -> 여섯번째 정보 노출 5초 -> 정보 미노출 5초 -> 노출 로직 종료
		* 이후 클라이언트 통신이 발생하는 액션을 취하고 한줄 공지 정보 호출을 한지 60초가 넘었을 때 추가적으로 서버에 저장된 정보를 재호출 및 노출 반복
	* 클라이언트에서 호출 시 서버에서는 호출하기 약 1분 전에 쌓인 정보를 저장 순서에 최근 정보 6개를 전송
		* 14:30:00 ~ 14:30:59 사이에 클라이언트가 호출했을 경우 14:29:00 ~ 14:29:59까지의 정보 중 최신 정보를 6개 전송
	* ** *예외 사항 : 발송할 정보 중 호출한 당사자의 정보가 있을 경우 정보 저장 순서와 관계 없이 당사자의 정보를 최우선으로 노출* **

* DB 한줄 공지 테이블 구성

|notice_no|team_name or user_no|item_no|level|player_no|card_type|notice_type|ipt_date|
|:-------:|:------------------:|:-----:|:---:|:-------:|:-------:|:---------:|:------:|
|        1|  201305100000000219|  90901|    0|    11213|   P|    A|2014-07-18 16:41:01|
|        2|  201305100000001231|  90411|    0|    11411|   W|    A|2014-07-18 16:41:02|
|        3|  201305100000121231|  90103|    0|    11412|   N|    A|2014-07-18 16:41:05|
|        4|  201305100000121111|  90003|    0|    11413|   N|    A|2014-07-18 16:41:06|
|        5|  201305100000000331|  90411|    0|    30100|   C|    A|2014-07-18 16:41:11|
|        6|  201405100000000931|  90411| NULL|     NULL|NULL|    B|2014-07-18 16:41:16|
|        7|  201305100000011231|   NULL|   10|    11415|   W|    A|2014-07-18 16:41:20|
|        8|  201305100000011231|   NULL|   10|    11416|   P|    A|2014-07-18 16:41:22|
|        9|  201305100000010231|   NULL|    5|    11417|   W|    A|2014-07-18 16:41:23|
|       10|  201305100000019231|   NULL|    5|    11418|   P|    A|2014-07-18 16:41:25|

.......................................................................................

|notice_no|team_name or user_no|item_no|level|player_no|card_type|notice_type|ipt_date|
|:-------:|:------------------:|:-----:|:---:|:-------:|:-------:|:---------:|:------:|
|      219|  201305100000000219|  90901|    0|    11213|   P|    A|2014-07-18 16:41:59|


* DB 테이블 설명
	* notice_no = 저장된 순서에 따른 번호
	* team_name = 구단명
	* user_no = 유저 번호
	* item_no = 아이템 번호
	* level = 선수 카드 레벨
	* player_no = 선수 번호
	* card_type = 카드 타입
		* W = 와일드 선수
		* P = 포텐셜 선수
		* N = 일반 선수
		* C = 축복 재료 클론 카드
	* notice_type = 공지 타입
		* A = 을(를) 획득
		* B = 을(를) 도전모드에서 획득
	* date = 정보가 저장된 시간

* DB 테이블 구성별 예시
	1. notice_no = 1
		* (나야감~team_name~)
		* (구단주가 선호 포텐 확정 쿠폰 상품~item_no~)
		* (에서 0레벨~level~)
		* (6골드 롯데 이상훈~player_no~)
		* (포텐셜 선수~card_type~)
		* (을(를) 획득~notice_type~)하였습니다.
	2. notice_no = 2
		* (나야감2~team_name~)
		* (구단주가 2000년대 와일드카드 쿠폰 상품~item_no~)
		* (에서 0레벨~level~)
		* (8골드 롯데 이상훈~player_no~)
		* (와일드 선수~card_type~)
		* (을(를) 획득~notice_type~)하였습니다.
	3. notice_no = 3
		* (나야감3~team_name~)
		* (구단주가 KBO 연도 프리미엄 상품~item_no~)
		* (에서 0레벨~level~)
		* (10골드 롯데 이상훈~player_no~)
		* (일반 선수~card_type~)
		* (을(를) 획득~notice_type~)하였습니다.
	4. notice_no = 4
		* (나야감4~team_name~)
		* (구단주가 KBO 프리미엄 상품~item_no~)
		* (에서 0레벨~level~)
		* (10골드 롯데 이상훈~player_no~)
		* (일반 선수~card_type~)
		* (을(를) 획득~notice_type~) 하였습니다.
	5. notice_no = 5
		* (나야감5~team_name~)
		* (구단주가 2000년대 와일드카드 쿠폰 상품~item_no~)
		* (에서 0레벨~level~)
		* (10골드 SS레어~player_no~)
		* (축복 재료 클론 카드~card_type~)
		* (을(를) 획득~notice_type~)하였습니다.
	6. notice_no = 6
		* (나야감6~team_name~)
		* (구단주가 2000년대 와일드카드 쿠폰 상품~item_no~)
		* (을(를) 도전모드에서 획득 ~grade, player_no, card_type, notice_type = NULL~) 하였습니다.
	7. notice_no = 7
		* (나야감7~team_name~)
		* (구단주가 클론 강화~item_no = NULL~)
		* (에서 10레벨~level~)
		* (10골드 롯데 이상훈~player_no~)
		* (포텐셜 선수~card_type~)
		* (을(를) 획득~notice_type~)하였습니다.
	8. notice_no = 8
		* (나야감8~team_name~)
		* (구단주가 클론 강화~item_no = NULL~)
		* (에서 10레벨~level~)
		* (7골드 롯데 이상훈~player_no~)
		* (포텐셜 선수~card_type~)
		* (을(를) 획득~notice_type~)하였습니다.
	9. notice_no = 9
		* (나야감9~team_name~)
		* (구단주가 클론 강화~item_no = NULL~)
		* (에서 5레벨~level~)
		* (8골드 롯데 이상훈~player_no~)
		* (와일드 선수~card_type~)
		* (을(를) 획득~notice_type~)하였습니다.
	10. notice_no = 10
		* (나야감10~team_name~)
		* (구단주가 클론 강화~item_no = NULL~)
		* (에서 5레벨~level~)
		* (10골드 롯데 이상훈~player_no~)
		* (포텐셜 선수~card_type~)
		* (을(를) 획득~notice_type~)하였습니다.

* 클라이언트 노출시 요청 사항
	1. card_type = W 일 경우 공지 배경으로 금색바 사용
	2. card_type = P 일 경우 공지 배경으로 은색바 사용
	3. card_type = N or C 일 경우 공지 배경으로 검은색바 사용
	4. team_name과 player_no의 텍스트 컬러 = #00bfFf(deepskyblue) 사용
	5. team_name과 player_no는 볼드체 사용
	

* 노출 정보 리스트

	* **KBO 프리미엄 상품 내 10골드 선수 획득**
		> XXXXXXX 구단주가 KBO 프리미엄 상품에서 10골드 XX XXX선수를 획득하였습니다.

	* **KBO 연도 프리미엄 상품 내 10골드 선수 획득**
		> XXXXXXX 구단주가 KBO 연도 프리미엄 상품에서 10골드 XX XXX선수를 획득하였습니다.

	* **KBO 포텐셜 연도 - 노멀/스페셜 뽑기 내 7골드 이상 포텐셜 선수 획득**
		> XXXXXXX 구단주가 KBO 포텐셜 연도 - 노멀/스페셜 상품에서 X골드 XX XXX선수를 획득하였습니다.(배경 은색)

	* **KBO 포텐셜 구단 - 노멀/스페셜 뽑기 내 7골드 이상 포텐셜 선수 획득**
		> XXXXXXX 구단주가 KBO 포텐셜 구단 - 노멀/스페셜 상품에서 X골드 XX XXX선수를 획득하였습니다.(배경 은색)

	* **KBO 포텐셜 연도/구단 - 노멀/스페셜 뽑기 내 와일드 선수 획득**
		> XXXXXXX 구단주가 KBO 포텐셜 구단 - 노멀/스페셜 상품에서 XX XXX 와일드 선수를 획득하였습니다.(배경 금색)

	* **KBO 포텐셜 프리미엄 상품 내 7골드 이상 포텐셜 선수 획득**
		> XXXXXXX 구단주가 KBO 포텐셜 프리미엄 상품에서 X골드 XX XXX선수를 획득하였습니다.(배경 은색)

	* **90년/2000년대 와일드 프리미엄 상품 내 포텐셜/와일드 선수 획득**
		> XXXXXXX 구단주가 90/2000년대 와일드 프리미엄 상품에서 X골드 XX XXX선수를 획득하였습니다.(배경 은색)
		
		> XXXXXXX 구단주가 90/2000년대 와일드 프리미엄 상품에서 XX XXX 와일드 선수를 획득하였습니다.(배경 금색)

	* **도전모드 내 90/2000년 와일드 프리미엄 쿠폰 획득**
		> XXXXXXX 구단주가 도전모드에서 90/2000년대 와일드 프리미엄 쿠폰을 획득하였습니다.(배경 금색)

	* **포텐셜 선수 Lv 5. 강화 완료시**
		> XXXXXXX 구단주가 XX골드 XX XXX선수의 Lv.5강화를 달성하였습니다.(배경 은색)

	* **와일드 선수 Lv 5. 강화 완료시**
		> XXXXXXX 구단주가 XX골드 XX XXX 와일드 선수의 Lv.5강화를 달성하였습니다.(배경 금색)

	* **포텐셜 선수 Lv 10. 강화 완료시**
		> XXXXXXX 구단주가 XX골드 XX XXX선수의 Lv.10강화를 달성하였습니다.(배경 은색)

	* **와일드 선수 Lv 10. 강화 완료시**
		> XXXXXXX 구단주가 XX골드 XX XXX 와일드 선수의 Lv.10강화를 달성하였습니다.(배경 금색)


#### ==월간 패키지 상품 시스템화==
* 기능 설명
	* 특정 상황 시 패키지 상품 구매 팝업이 등장하고 해당 팝업을 통해 패키지 상품을 구매할 수 있음
	* 패키지 상품은 Coin과 더불어 특정 상품들이 추가 구성되어 있고 패키지 상품별로 구성을 달리 할 수 있음
* 도입 배경
	* 현 패키지 상품은 지급시까지 시간이 소요되기 때문에 유저가 필요하다고 느낄 때 해당 상품에 바로 접근할 수 없는 단점이 존재
	* 패키지 상품을 통해 직,간접적인 구매를 유도하여 고비용 상품에 대한 판매량을 늘리고자 함
* 목표
	* 일간 총 4회의 패키지 팝업 노출
		* 00:00:00 ~ 05:59:59 - 1차
		* 06:00:00 ~ 11:59:59 - 2차
		* 12:00:00 ~ 17:59:59 - 3차
		* 18:00:00 ~ 23:59:59 - 4차
	* 패키지 상품은 유저 패턴 및 조건에 따라 노출시킬 필요가 있음
		* 최근 1일 이내에 KBO 프리미엄, KBO 연도 프리미엄, KBO 포텐셜 프리미엄, 90/2000년대 와일드 카드, 강화잼(150개) 상품을 종류에 관계 없이 5개 이상 구매한 유저는 ** *고 과금 유저로 분류* **
		* 최근 1일 이내에 KBO 프리미엄, KBO 연도 프리미엄, KBO 포텐셜 프리미엄, 90/2000년대 와일드 카드, 강화잼(150개) 상품을 종류에 관계 없이 3개 이상 구매한 유저는 ** *중 과금 유저로 분류* **
		* 최근 1일 이내에 KBO 프리미엄, KBO 연도 프리미엄, KBO 포텐셜 프리미엄, 90/2000년대 와일드 카드, 강화잼(150개) 상품을 종류에 관계 없이 1개 이상 구매한 유저는 ** *저 과금 유저로 분류* **
		* 최근 1일 이내에 KBO 프리미엄, KBO 연도 프리미엄, KBO 포텐셜 프리미엄, 90/2000년대 와일드 카드, 강화잼(150개) 상품을 종류에 관계 없이 0개 구매한 유저는 ** *무 과금 유저로 분류* **
* 수행 방식
	* product_cash_no - 21 ~ 25 추가
	* 특정 상황 시 패키지 상품을 구매할 수 있는 팝업 창 생성(product_cash_no - 21 ~ 25 구매 가능)
		* 패키지 상품 팝업은 한번에 한개의 팝업만 띄우는 것을 원칙으로 함
		* 한개의 팝업 안에 1개의 패키지 상품이 노출
	* 팝업창 구매 페이지 이동을 통해 각 마켓의 상품 구매
	* 상품 구매 후 유저가 받는 리턴 값(21 ~ 25)에 따라 DB 패키지 보상 테이블에 설정된 아이템을 선물함으로 즉시 지급

* product_cash_no 에 따른 캐시 상품 테이블(** *[shop].[PRODUCT_CASH]* **) 구성
|product_cash_no|product_name|product_cose|product_reward|open_tag|product_intro|ipt_time|upt_time|sort_no|image_no|
|:------:|:------:|:------:|:------:|:------:|:------:|:------:|:------:|:------:|:------:|
|21|코인더미 패키지|5000|5500|Y|5000원 패키지 상품|0000-00-00 00:00:00|0000-00-00 00:00:00|21|1|
|22|코인자루 패키지|10000|11500|Y|10000원 패키지 상품|0000-00-00 00:00:00|0000-00-00 00:00:00|22|2|
|23|코인상자 패키지|30000|37500|Y|30000원 패키지 상품|0000-00-00 00:00:00|0000-00-00 00:00:00|23|3|
|24|코인금고 패키지|50000|68000|Y|50000원 패키지 상품|0000-00-00 00:00:00|0000-00-00 00:00:00|24|4|
|25|코인트럭 패키지|100000|145000|Y|100000원 패키지 상품|0000-00-00 00:00:00|0000-00-00 00:00:00|25|5|

* product_cash_no 에 따른 추가 상품 테이블(** *[shop].[PRODUCT_CASH_PACKAGE]* **) 구성
|product_cash_no|product_name|item_reward1|item_reward1_count|item_reward2|item_reward2_count|item_reward3|item_reward3_count|item_reward4|item_reward4_count|item_reward5|item_reward5_count|
|:------:|:------:|:------:|:------:|:------:|:------:|:------:|:------:|:------:|:------:|:------:|:------:|
|21|코인더미 패키지|90901|1|0|0|0|0|0|0|0|0|
|22|코인자루 패키지|90901|1|90902|1|0|0|0|0|0|0|
|23|코인상자 패키지|90901|2|90902|2|90903|1|0|0|0|0|
|24|코인금고 패키지|90901|2|90902|2|90903|1|90904|2|0|0|
|25|코인트럭 패키지|90901|2|90902|2|90903|1|90904|2|90905|2|

		* DB 보상 테이블 구성 필요
		* 구매 관련 통신시 주고받는 값에 대한 정의 필요
		* product_cash_no = 21 ~ 25 패키지 상품 구매에 따른 리워드 아이템 자동 지급 프로토콜 구성 필요
		* 구성 상품의 변경이 가능하도록 운영툴에서 변경이 가능하도록 개발 필요
			* CDN 및 추가 상품 테이블 변경이 필요하므로 서버 재시작을 염두에 두고 개발

* 클라이언트 요청 사항
		* 유저 분류
			* 고과금 유저 = 1
			* 중과금 유저 = 2
			* 저과금 유저 = 3
			* 무과금 유저 = 4
		* 분류 근거
			* 접속 후 24시간 이내의 상품 구매 내역 조회 후 분류표에 따라 유저 분류
		* 분류 방법
			* 최초 게임 접속 시 DB에서 해당 유저의 아이템 구매 로그 확인 후 유저 분류에 따라 값을 캐싱
			* 유저 분류 값에 따라 1개의 패키지 상품 팝업이 확률에 따라 노출
			* 재 접속 시 아이템 구매로그 재 확인 필요
	* 패키지 상품 팝업 확률 테이블
|유저 분류|21번 상품 노출 확률|22번 상품 노출 확률|23번 상품 노출 확률|24번 상품 노출 확률|25번 상품 노출 확률|
|:------:|:------:|:------:|:------:|:------:|:------:|
|1|0|500|1000|3000|5500|
|2|0|500|1500|5000|3000|
|3|2000|2000|1000|2500|2500|
|4|3000|1500|1500|3000|1000|
	* 메인 화면 진입 시 확률에 따라 1개의 패키지 상품 팝업이 노출
		* 일간 총 4회 노출 가능
		* 매 호출시 마다 패키지 상품 노출 확률에 따라 노출
			* 00:00:00 ~ 05:59:59 - 1차
			* 06:00:00 ~ 11:59:59 - 2차
			* 12:00:00 ~ 17:59:59 - 3차
			* 18:00:00 ~ 23:59:59 - 4차
	* 팝업 메인이미지는 변경이 없으나 패키지 별 이미지는 변경이 필요하므로 CDN을 통해 다운로드 받을 수 있도록 하여 패키지 상품 리소스를 관리

* 필요 디자인 리소스
	* 팝업 메인 이미지 필요
	* 각 패키지 별 이미지 필요


#### 도전 모드 개선
* 개선 내용
	* 기존 기능
		* 게임 내 보유한 선수 카드를 통해 진행 가능한 싱글플레이 모드
* 개선 내용
	* 도전모드 구조 변경
	* 도전모드 보상 테이블 수정
* 개선 효과
	* 신규 유저는 도전모드를 통하여 게임을 이해할 수 있도록 하고자 함
	* 하위 유저는 덱에 대한 제시를 통하여 나아가야할 방향을 인지 시키고자 함
	* 중상위 유저는 상위 유저를 따라갈 수 있는 발판을 마련시키고자 함
	* 상위 유저는 지속적인 보상 획득을 통해 현재의 위치를 유지시킬 수 있도록 돕고자 함
* 개선 방식
	* 초급, 중급, 고급 탭으로 구성
	* 각 급별로 최소 60레벨의 스테이지를 제공
		* 스테이지 클리어 시 같은 급의 다음 레벨 스테이지 오픈 및 다음 급의 동일 레벨 스테이지 오픈
|클리어한 스테이지|오픈될 스테이지|
|:------------:|:----------:|
|초급 1레벨|초급 2레벨, 중급 1레벨|
|초급 2레벨|초급 3레벨, 중급 2레벨|
|초급 3레벨|초급 4레벨, 중급 3레벨|
...................................
|클리어한 스테이지|오픈될 스테이지|
|:------------:|:----------:|
|초급 59레벨|초급 60레벨, 중급 59레벨|
|초급 60레벨|중급 60레벨|
|중급 1레벨|중급 2레벨, 고급 1레벨|
|중급 2레벨|중급 3레벨, 고급 2레벨|
|중급 3레벨|중급 4레벨, 고급 3레벨|
...................................
|클리어한 스테이지|오픈될 스테이지|
|:------------:|:----------:|
|중급 59레벨|중급 60레벨, 고급 59레벨|
|중급 60레벨|고급 60레벨|
	* 초,중,고급의 스테이지는 스테이지 넘버에 따라 동일한 덱으로 구성되어 있고 스탯을 다르게 하여 같은 팀이지만 난이도를 다르게 함
